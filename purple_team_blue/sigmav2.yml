|
  title: Suspicious PowerShell Execution via CMD
  id: 574c5012-b078-4c5c-8c9f-e674a4b4b695
  status: experimental
  description: Detects instances where PowerShell commands are executed via cmd.exe by the admin user. This activity may indicate unauthorized administrative actions or exploitation attempts leveraging cmd.exe to call PowerShell.
  references:
    - https://docs.microsoft.com/en-us/powershell/scripting/samples/using-powershell-commands?view=powershell-7.2
    - https://attack.mitre.org/techniques/T1059/001/
    - https://www.sans.org/white-papers/39155/
  author: AI Detection Crew
  date: 2023/10/01
  modified: 2023/10/01
  tags:
    - attack.execution
    - attack.t1059.001
    - attack.powershell
  falsepositives:
    - Expected behavior when system administrators use cmd.exe to execute PowerShell scripts for legitimate administration tasks, particularly in enterprise environments where cmd.exe is often used.
    - Automated tasks and scheduled scripts that rely on PowerShell executed through cmd.exe.
  level: high
  logsource:
    product: windows
    service: security
    category: process_creation
  detection:
    selection:
      EventID: 4688
      CommandLine: '*powershell*'
      FileName: 'cmd.exe'
    filter:
      TargetUserName: 'admin'
    condition: selection and not filter